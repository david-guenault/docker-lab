# node1 = 10.10.0.5
# node2 = 10.20.0.21
# node3 = 10.20.0.22
etcd1:  
    image: dguenault/etcd:0.4.6
    name: etcd1
    hostname: etcd1
    ports:
        - "10.20.0.21:4001:4001"
        - "10.20.0.21:7001:7001"
    volumes: 
        - /etc/localtime:/etc/localtime:ro
    command: -peer-addr 10.20.0.21:7001 -addr 10.20.0.21:4001 -data-dir machines/etcd1 -name etcd1
    environment:
        - constraint:storage=node2

etcd2:  
    image: dguenault/etcd:0.4.6
    name: etcd2
    hostname: etcd2
    ports:
        - "4001:4001"
        - "7001:7001"
    links:
        - etcd1:etcd1
    volumes: 
        - /etc/localtime:/etc/localtime:ro
    command: -peer-addr 10.10.0.5:7001 -addr 10.10.0.5:4001 -peers 10.20.0.21:7001,10.10.0.5:7001,10.10.0.22:7001  -data-dir machines/etcd2 -name etcd2
    environment:
        - constraint:storage=node1

etcd3:  
    image: dguenault/etcd:0.4.6
    name: etcd3
    hostname: etcd3
    links:
        - etcd1:etcd1
        - etcd2:etcd2
    ports:
        - "4001:4001"
        - "7001:7001"
    volumes: 
        - /etc/localtime:/etc/localtime:ro
    command: -peer-addr 10.10.0.22:7001 -addr 10.10.0.22:4001 -peers 10.20.0.21:7001,10.10.0.5:7001,10.10.0.22:7001  -data-dir machines/etcd3 -name etcd3
    environment:
        - constraint:storage=node3

skydns1:
    image: dguenault/skydns:latest
    name: skydns1
    hostname: skydns1
    links:
        - etcd1:etcd1
        - etcd2:etcd2
        - etcd3:etcd3
    ports:
        - 10.20.0.21:53:53/udp
    command: -machines=10.20.0.21:4001,10.10.0.22:4001,10.10.0.5:4001 -addr=0.0.0.0:53 -domain=dock2dns.lan -nameservers=8.8.8.8:53
        - /etc/localtime:/etc/localtime:ro
    environment:
        - constraint:storage=node2

skydns2:
    image: dguenault/skydns:latest
    name: skydns2
    hostname: skydns2
    links:
        - etcd1:etcd1
        - etcd2:etcd2
        - etcd3:etcd3
    ports:
        - 10.10.0.5:53:53/udp
    command: -machines=10.20.0.21:4001,10.10.0.22:4001,10.10.0.5:4001 -addr=0.0.0.0:53  -domain=dock2dns.lan -nameservers=8.8.8.8:53
    volumes:
        - /etc/localtime:/etc/localtime:ro
    environment:
        - constraint:storage=node1

skydns3:
    image: dguenault/skydns:latest
    name: skydns3
    hostname: skydns3
    links:
        - etcd1:etcd1
        - etcd2:etcd2
        - etcd3:etcd3
    ports:
        - 10.10.0.22:53:53/udp
    command: -machines=10.20.0.21:4001,10.10.0.22:4001,10.10.0.5:4001 -addr=0.0.0.0:53  -domain=dock2dns.lan -nameservers=8.8.8.8:53
    volumes:
        - /etc/localtime:/etc/localtime:ro
    environment:
        - constraint:storage=node3